library(tidyverse)
t1 = read_csv("symptoms.csv")
glimpse(t1)
t2 = t1 %>% mutate (Age = NA) %>%
mutate (Age = ifelse(Age_0_9 == 1 & is.na(Age), "A", Age)) %>%
mutate (Age = ifelse(Age_10_19 == 1 & is.na(Age), "B", Age)) %>%
mutate (Age = ifelse(Age_20_24 == 1 & is.na(Age), "C", Age)) %>%
mutate (Age = ifelse(Age_25_59 == 1 & is.na(Age), "D", Age)) %>%
mutate (Age = ifelse(Age_75 == 1 & is.na(Age), "E", Age)) %>%
select (-Age_0_9, -Age_10_19, -Age_20_24, -Age_25_59, -Age_75)
glimpse(t2)
t3 = t2 %>% mutate (Contact = NA) %>%
mutate (Contact = ifelse(Contact_No == 1 & is.na(Contact), "N", Contact)) %>%
mutate (Contact = ifelse(Contact_Yes == 1 & is.na(Contact), "Y", Contact)) %>%
select (-Contact_No, -Contact_Yes, -Contact_Dont_Know)
glimpse(t3)
t4 = t3 %>% mutate (Sex = NA) %>%
mutate (Sex = ifelse(Gender_Female == 1 & is.na(Sex), "F", Sex)) %>%
mutate (Sex = ifelse(Gender_Male == 1 & is.na(Sex), "M", Sex)) %>%
select (-Gender_Female, -Gender_Male, -Gender_Transgender)
glimpse(t4)
t5 = t4 %>% mutate (Severity = NA) %>%
mutate (Severity = ifelse(Severity_Mild == 1 & is.na(Severity), "Mild", Severity)) %>%
mutate (Severity = ifelse(Severity_Moderate == 1 & is.na(Severity), "Moderate", Severity)) %>%
mutate (Severity = ifelse(Severity_None == 1 & is.na(Severity), "None", Severity)) %>%
mutate (Severity = ifelse(Severity_Severe == 1 & is.na(Severity), "Severe", Severity)) %>%
select (-Severity_Mild, -Severity_Moderate, -Severity_None, -Severity_Severe)
glimpse(t5)
t6 = t5 %>% select (Country, Sex, Age, Contact,
Fever, Tiredness, Dry_Cough,
Difficulty_in_Breathing, Sore_Throat,
None_Sympton, Pains,
Nasal_Congestion, Runny_Nose,
Diarrhea, None_Experiencing, Severity)
glimpse(t6)
t7 = t6 %>% mutate (Country = factor(Country),
Sex = factor(Sex),
Age = factor(Age),
Contact = factor(Contact),
Fever = factor(Fever),
Tiredness = factor(Tiredness),
Dry_Cough = factor(Dry_Cough),
Difficulty_in_Breathing = factor(Difficulty_in_Breathing),
Sore_Throat = factor(Sore_Throat),
None_Sympton = factor(None_Sympton),
Pains = factor(Pains),
Nasal_Congestion = factor(Nasal_Congestion),
Runny_Nose = factor(Runny_Nose),
Diarrhea = factor(Diarrhea),
None_Experiencing = factor(None_Experiencing),
Severity = factor(Severity, levels = c("None", "Mild", "Moderate", "Severe")))
glimpse(t7)
summary(t7)
t8 = t7 %>% na.omit()
summary(t8)
t9  = t8 %>% mutate (Country = as.numeric(Country),
Sex = as.numeric(Sex),
Age = as.numeric(Age),
Contact = as.numeric(Contact),
Fever = as.numeric(Fever),
Tiredness = as.numeric(Tiredness),
Dry_Cough = as.numeric(Dry_Cough),
Difficulty_in_Breathing = as.numeric(Difficulty_in_Breathing),
Sore_Throat = as.numeric(Sore_Throat),
None_Sympton = as.numeric(None_Sympton),
Pains = as.numeric(Pains),
Nasal_Congestion = as.numeric(Nasal_Congestion),
Runny_Nose = as.numeric(Runny_Nose),
Diarrhea = as.numeric(Diarrhea),
None_Experiencing = as.numeric(None_Experiencing),
Severity = as.numeric(Severity))
summary(t9)
m = as.matrix(t9 %>% select(-Severity))
pca = prcomp(m, scale. = TRUE)
summary(pca)
plot(pca)
df = t7 %>% bind_columsn (pca$x[, 1:5])
head(df)
df = t7 %>% bind_cols (pca$x[, 1:5])
df = t8 %>% bind_cols (pca$x[, 1:5])
head(df)
View(df)
df = t8 %>% bind_cols (PC1 = pca$x[, 1])
head(df)
View(df)
df = t8 %>% bind_cols (PC1 = pca$x[, 1], PC1 = pca$x[, 2], PC1 = pca$x[, 3], PC1 = pca$x[, 4])
head(df)
ggplot(df) +
geom_point (aes(x = PC1, y = PC2, color = Severity), alpha = 0.6)
df = t8 %>% bind_cols (PC1 = pca$x[, 1], PC1 = pca$x[, 2], PC1 = pca$x[, 3], PC1 = pca$x[, 4])
head(df)
glimpse(df)
head(pca$)
head(pca$x)
df = t8 %>% add_column (PC1 = pca$x[, 1], PC2 = pca$x[, 2], PC3 = pca$x[, 3])
head(df)
glimpse(df)
df = t8 %>% add_column (pca$x[, 1:4])
head(df)
glimpse(df)
df = t8 %>% add_column (PC1 = pca$x[, 1], PC2 = pca$x[, 2], PC3 = pca$x[, 3], PC4 = pca$x[, 4])
head(df)
glimpse(df)
ggplot(df) +
geom_point (aes(x = PC1, y = PC2, color = Severity), alpha = 0.6)
View(df)
library(tidyverse)
t1 = read_csv("symptoms.csv")
glimpse(t1)
t2 = t1 %>% mutate (Age = NA) %>%
mutate (Age = ifelse(Age_0_9 == 1 & is.na(Age), "A", Age)) %>%
mutate (Age = ifelse(Age_10_19 == 1 & is.na(Age), "B", Age)) %>%
mutate (Age = ifelse(Age_20_24 == 1 & is.na(Age), "C", Age)) %>%
mutate (Age = ifelse(Age_25_59 == 1 & is.na(Age), "D", Age)) %>%
mutate (Age = ifelse(Age_75 == 1 & is.na(Age), "E", Age)) %>%
select (-Age_0_9, -Age_10_19, -Age_20_24, -Age_25_59, -Age_75)
glimpse(t2)
t3 = t2 %>% mutate (Contact = NA) %>%
mutate (Contact = ifelse(Contact_No == 1 & is.na(Contact), "N", Contact)) %>%
mutate (Contact = ifelse(Contact_Yes == 1 & is.na(Contact), "Y", Contact)) %>%
select (-Contact_No, -Contact_Yes, -Contact_Dont_Know)
glimpse(t3)
t4 = t3 %>% mutate (Sex = NA) %>%
mutate (Sex = ifelse(Gender_Female == 1 & is.na(Sex), "F", Sex)) %>%
mutate (Sex = ifelse(Gender_Male == 1 & is.na(Sex), "M", Sex)) %>%
select (-Gender_Female, -Gender_Male, -Gender_Transgender)
glimpse(t4)
t5 = t4 %>% mutate (Severity = NA) %>%
mutate (Severity = ifelse(Severity_Mild == 1 & is.na(Severity), "Mild", Severity)) %>%
mutate (Severity = ifelse(Severity_Moderate == 1 & is.na(Severity), "Moderate", Severity)) %>%
mutate (Severity = ifelse(Severity_None == 1 & is.na(Severity), "None", Severity)) %>%
mutate (Severity = ifelse(Severity_Severe == 1 & is.na(Severity), "Severe", Severity)) %>%
select (-Severity_Mild, -Severity_Moderate, -Severity_None, -Severity_Severe)
glimpse(t5)
t6 = t5 %>% select (Country, Sex, Age, Contact,
Fever, Tiredness, Dry_Cough,
Difficulty_in_Breathing, Sore_Throat,
None_Sympton, Pains,
Nasal_Congestion, Runny_Nose,
Diarrhea, None_Experiencing, Severity)
glimpse(t6)
t7 = t6 %>% mutate (Country = factor(Country),
Sex = factor(Sex),
Age = factor(Age),
Contact = factor(Contact),
Fever = factor(Fever),
Tiredness = factor(Tiredness),
Dry_Cough = factor(Dry_Cough),
Difficulty_in_Breathing = factor(Difficulty_in_Breathing),
Sore_Throat = factor(Sore_Throat),
None_Sympton = factor(None_Sympton),
Pains = factor(Pains),
Nasal_Congestion = factor(Nasal_Congestion),
Runny_Nose = factor(Runny_Nose),
Diarrhea = factor(Diarrhea),
None_Experiencing = factor(None_Experiencing),
Severity = factor(Severity, levels = c("None", "Mild", "Moderate", "Severe")))
glimpse(t7)
summary(t7)
t8 = t7 %>% na.omit()
summary(t8)
t9  = t8 %>% mutate (Country = as.numeric(Country),
Sex = as.numeric(Sex),
Age = as.numeric(Age),
Contact = as.numeric(Contact),
Fever = as.numeric(Fever),
Tiredness = as.numeric(Tiredness),
Dry_Cough = as.numeric(Dry_Cough),
Difficulty_in_Breathing = as.numeric(Difficulty_in_Breathing),
Sore_Throat = as.numeric(Sore_Throat),
None_Sympton = as.numeric(None_Sympton),
Pains = as.numeric(Pains),
Nasal_Congestion = as.numeric(Nasal_Congestion),
Runny_Nose = as.numeric(Runny_Nose),
Diarrhea = as.numeric(Diarrhea),
None_Experiencing = as.numeric(None_Experiencing),
Severity = as.numeric(Severity))
summary(t9)
m = as.matrix(t9 %>% select(-Severity))
pca = prcomp(m, scale. = TRUE)
summary(pca)
plot(pca)
head(pca$x)
df = t8 %>% add_column (PC1 = pca$x[, 1], PC2 = pca$x[, 2], PC3 = pca$x[, 3], PC4 = pca$x[, 4])
head(df)
glimpse(df)
ggplot(df) +
geom_point (aes(x = PC1, y = PC2, color = Severity), alpha = 0.6)
ggplot(df) +
geom_jitter (aes(x = PC1, y = PC2, color = Severity), alpha = 0.6)
View(df)
hist(df$PC1)
hist(df$PC2)
summary(t9)
x = t1 %>% mutate (Country = as.numeric(factor(Country)))
glimpse(x)
m = as.matrix(x)
pca = prcomp(m, scale. = TRUE)
summary(pca)
plot(pca)
head(pca$x)
df = t8 %>% add_column (PC1 = pca$x[, 1], PC2 = pca$x[, 2], PC3 = pca$x[, 3], PC4 = pca$x[, 4])
df = x %>% add_column (PC1 = pca$x[, 1], PC2 = pca$x[, 2], PC3 = pca$x[, 3], PC4 = pca$x[, 4])
head(df)
glimpse(df)
ggplot(df) +
geom_jitter (aes(x = PC1, y = PC2, color = Severity), alpha = 0.6)
ggplot(df) +
geom_jitter (aes(x = PC1, y = PC2, color = Country), alpha = 0.6)
library(tidyverse)
setwd("~/Projects/heart")
t1 = read_tsv("heart.tsv")
t2 = add_column(index = 1:nrow(t1), t1)
head(t2)
t2 = data.frame(index = 1:nrow(t1), t1)
head(t2)
t3 = t2 %>% rename(condition = target)
head(t3)
t2 = data.frame(id = 1:nrow(t1), t1)
head(t2)
t3 = t2 %>% rename(condition = target)
head(t3)
t2 = data.frame(id = 1:nrow(t1), t1)
head(t2)
t3 = t2 %>% rename(condition = target)
head(t3)
write_tsv(t3, "heart.tsv")
t1 = read_tsv("heart.tsv")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
heart = read_tsv("https://raw.githubusercontent.com/ahmedmoustafa/Notebooks/master/heart.tsv")
glimpse(heart)
train_indexes = slice_sample(heart %>% group_by(heart), prop = 0.9, replace = FALSE)
heart = read_tsv("https://raw.githubusercontent.com/ahmedmoustafa/Notebooks/master/heart.tsv")
glimpse(heart)
train_indexes = slice_sample(heart %>% group_by(condition), prop = 0.9, replace = FALSE)
summary(train_indexes)
heart = read_tsv("https://raw.githubusercontent.com/ahmedmoustafa/Notebooks/master/heart.tsv")
glimpse(heart)
heart = read_tsv("https://raw.githubusercontent.com/ahmedmoustafa/Notebooks/master/heart.tsv") %>% rename(diagnosis = condition)
glimpse(heart)
heart = read_tsv("https://raw.githubusercontent.com/ahmedmoustafa/Notebooks/master/heart.tsv") %>% rename(diagnosis = condition)
glimpse(heart)
train_indexes = slice_sample(heart %>% group_by(condition), prop = 0.9, replace = FALSE)
train_indexes = slice_sample(heart %>% group_by(diagnosis), prop = 0.9, replace = FALSE)
summary(train_indexes)
slice = slice_sample(heart %>% group_by(diagnosis), prop = 0.9, replace = FALSE)
train = heart[slice$id, ]
slice = slice_sample(heart %>% group_by(diagnosis), prop = 0.9, replace = FALSE)
train = heart[slice$id, ]
glimpse(train)
slice = slice_sample(heart %>% group_by(diagnosis), prop = 0.95, replace = FALSE)
train = heart[slice$id, ]
glimpse(train)
slice = slice_sample(heart %>% group_by(diagnosis), prop = 0.99, replace = FALSE)
train = heart[slice$id, ]
glimpse(train)
slice = slice_sample(heart %>% group_by(diagnosis), prop = 0.95, replace = FALSE)
train = heart[slice$id, ]
glimpse(train)
train = slice_sample(heart %>% group_by(diagnosis), prop = 0.95, replace = FALSE)
glimpse(train)
test = heart[-train$id, ]
glimpse(test)
train = slice_sample(heart %>% group_by(diagnosis), prop = 0.95, replace = FALSE) %>% arrange(id)
glimpse(train)
test = heart[-train$id, ]
glimpse(test)
set.seed(123)
train = slice_sample(heart %>% group_by(diagnosis), prop = 0.95, replace = FALSE) %>% arrange(id)
glimpse(train)
test = heart[-train$id, ]
glimpse(test)
set.seed(123)
train = slice_sample(heart %>% group_by(diagnosis), prop = 0.95, replace = FALSE) %>% arrange(id)
glimpse(train)
test = heart[-train$id, ]
glimpse(test)
m = train %>% select(-id, -diagnosis)
head(m)
library(printr)
m = train %>% select(-id, -diagnosis)
head(m)
pca = prcomp(m, scale. = TRUE)
pca
summary(pca)
plot(pca)
mydata = train %>% add_column (PC1 = pca$x[, 1], PC2 = pca$x[, 2], PC3 = pca$x[, 3])
glimpse(mydata)
t1 = train %>% add_column (PC1 = pca$x[, 1], PC2 = pca$x[, 2], PC3 = pca$x[, 3])
glimpse(t1)
t2 = t1 %>% mutate (sex = factor(sex), cp = factor(cp), fbs = factor(fbs),
restecg = factor(restecg), exang = factor(exang), slope = factor(slope),
ca = factor(ca), thal = factor(thal), diagnosis = factor(diagnosis))
glimpse(t2)
ggplot (t2) +
geom_point(aes (x = PC1, y = PC2, color = diagnosis), size = 5, alpha = 0.8)
barplot(pca$rotation[, 1])
m = train %>% select(-id, -diagnosis)
head(m)
pca = prcomp(m, scale. = TRUE)
pca
m = train %>% select(-id, -diagnosis)
head(m)
m = train %>% ungroup() %>% select(-id, -diagnosis)
head(m)
pca = prcomp(m, scale. = TRUE)
pca
summary(pca)
plot(pca)
t1 = train %>% add_column (PC1 = pca$x[, 1], PC2 = pca$x[, 2], PC3 = pca$x[, 3])
glimpse(t1)
t2 = t1 %>% mutate (sex = factor(sex), cp = factor(cp), fbs = factor(fbs),
restecg = factor(restecg), exang = factor(exang), slope = factor(slope),
ca = factor(ca), thal = factor(thal), diagnosis = factor(diagnosis))
glimpse(t2)
ggplot (t2) +
geom_point(aes (x = PC1, y = PC2, color = diagnosis), size = 5, alpha = 0.8)
barplot(pca$rotation[, 1])
# This is to extract the loadings from the pca variable
# The row names of the rotation matrix will be used as a new column,
# which we are going to call it parameter
# Then the data.frame is converted in tibble (a tidyverse structure for tables)
loadings = rownames_to_column(as.data.frame(pca$rotation), var = "parameter") %>% as_tibble()
loadings
ggplot(loadings) +
geom_bar(aes(x = parameter, y = PC1), stat = "identity")
ggplot(loadings) +
geom_bar(aes(x = reorder (parameter, PC1, FUN = sum), y = PC1), stat = "identity")
predict(pca, test %>% select(-id, -diagnosis))
test %>% select(-id, -diagnosis)
prediction = predict(pca, test %>% select(-id, -diagnosis))
prediction
t3 = test %>% add_column(prediction$PC1, prediction$PC2)
prediction = predict(pca, test %>% select(-id, -diagnosis))
prediction
t3 = test %>% add_column(prediction$PC1, prediction$PC2)
t3 = test %>% add_column(PC1 = prediction[, 1], PC1 = prediction[, 2])
t3 = test %>% add_column(PC1 = prediction[, 1], PC2 = prediction[, 2])
glimpse(t3)
t3 = test %>% add_column(PC1 = prediction[, 1], PC2 = prediction[, 2], type = "test")
glimpse(t3)
t4 = t2 %>% mutate (type = "train") %>% bind_rows(t3)
t3 = test %>% mutate (sex = factor(sex), cp = factor(cp), fbs = factor(fbs),
restecg = factor(restecg), exang = factor(exang), slope = factor(slope),
ca = factor(ca), thal = factor(thal), diagnosis = factor(diagnosis)) %>%
add_column(PC1 = prediction[, 1],
PC2 = prediction[, 2],
type = "test")
glimpse(t3)
t4 = t2 %>% mutate (type = "train") %>% bind_rows(t3) %>% mutate (type = factor(type))
glimpse(t4)
ggplot (t4) +
geom_point(aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 5, alpha = 0.8)
ggplot (t4) +
geom_point(aes (x = PC1, y = PC2, color = type, shape = diagnosis), size = 5, alpha = 0.8)
ggplot (t4) +
geom_point(aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 3, alpha = 0.8)
ggplot (t4) +
geom_point(data = t3 = aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 3, alpha = 0.8)
ggplot (t4) +
geom_point(data = t3, aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 3, alpha = 0.8)
ggplot (t4) +
geom_point(data = t2, aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 3, alpha = 0.8)
ggplot (t4) +
geom_point(aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 3, alpha = 0.4)
geom_point(data = t2, aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 3, alpha = 0.8)
ggplot (t4) +
geom_point(aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 3, alpha = 0.4) +
geom_point(data = t2, aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 3, alpha = 0.8)
t4 = t2 %>% mutate (type = "train") %>% bind_rows(t3) %>% mutate (type = factor(type))
glimpse(t4)
ggplot (t4) +
geom_point(aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 3, alpha = 0.4) +
geom_point(data = t2, aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 3, alpha = 0.8)
ggplot (t4) +
geom_point(aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 3, alpha = 0.4) +
geom_point(data = t3, aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 3, alpha = 0.8)
ggplot (t4) +
geom_point(aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 3, alpha = 0.4) +
geom_point(data = t3, aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 5, alpha = 0.8)
ggplot (t2) +
geom_point(aes (x = PC1, y = PC2, color = diagnosis, shape = sex), size = 5, alpha = 0.8)
ggplot (t2) +
geom_point(aes (x = PC1, y = PC2, color = diagnosis, size = age), size = 5, alpha = 0.8)
ggplot (t2) +
geom_point(aes (x = PC1, y = PC2, color = diagnosis, size = age), alpha = 0.8)
ggplot (t2) +
geom_point(aes (x = PC1, y = PC2, color = diagnosis), alpha = 0.8)
ggplot (t2) +
geom_point(aes (x = PC1, y = PC2, color = diagnosis), size = 5, alpha = 0.8)
ggplot () +
geom_point(data = t2, aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 5, alpha = 0.4) +
geom_point(data = t3, aes (x = PC1, y = PC2, color = diagnosis, shape = type), size = 5, alpha = 0.8)
ggplot () +
geom_point(data = t2, aes (x = PC1, y = PC2, color = diagnosis), shape = 5, size = 5, alpha = 0.4) +
geom_point(data = t3, aes (x = PC1, y = PC2, color = diagnosis), shape = 7, size = 5, alpha = 0.8)
ggplot () +
geom_point(data = t2, aes (x = PC1, y = PC2, color = diagnosis), shape = 16, size = 5, alpha = 0.3) +
geom_point(data = t3, aes (x = PC1, y = PC2, color = diagnosis), shape = 17, size = 5, alpha = 0.8)
ggplot () +
geom_point(data = t2, aes (x = PC1, y = PC2, color = diagnosis), shape = 16, size = 5, alpha = 0.3) +
geom_point(data = t3, aes (x = PC1, y = PC2, color = diagnosis), shape = 17, size = 5, alpha = 0.9)
ggplot () +
geom_point(data = t2, aes (x = PC1, y = PC2, color = diagnosis), size = 5, alpha = 0.3) +
geom_point(data = t3, aes (x = PC1, y = PC2, color = diagnosis), size = 5, alpha = 0.9)
ggplot () +
geom_point(data = t2, aes (x = PC1, y = PC2, color = diagnosis), size = 5, alpha = 0.1) +
geom_point(data = t3, aes (x = PC1, y = PC2, color = diagnosis), size = 5, alpha = 0.9)
loadings = rownames_to_column(as.data.frame(pca$rotation), var = "parameter")
loadings
ggplot(loadings) +
geom_bar(aes(x = parameter, y = PC1), stat = "identity")
setwd("~/GDriveAUC/GitHub2/Notebooks/Heart")
